/*! si-table 0.0.1-beta.6 05-06-2014 */
!function(){angular.module("siTable.directives",[]),angular.module("siTable.filters",[]),angular.module("siTable",["siTable.directives","siTable.filters"]),angular.module("siTable.directives").directive("siTable",function(){return{restrict:"A",scope:{sorting:"=?"},controller:function(a){var b=this;this.paginationParams={offset:0,limit:1/0,remote:!1},this.sortingParams={sortArray:[]},a.$watch(function(){return b.sortingParams.sortArray},function(b){angular.isArray(a.sorting)||(a.sorting=[]),a.sorting.splice(0,a.sorting.length);for(var c=0;c<b.length;c++)a.sorting.push(b[c])},!0)}}}),angular.module("siTable.directives").directive("siTablePagination",function(){return{restrict:"AE",require:"^siTable",scope:{offset:"=?"},template:'    <ul class="pagination">    <li ng-class="{disabled: params.offset === 0}">    <a href ng-click="setPage(1)">First</a>    </li>    <li ng-class="{disabled: params.offset === 0}">    <a href ng-click="setPage(currPage - 1)">Previous</a>    </li>    <li ng-repeat="page in showPages"    ng-class="{active: currPage === page}">    <a href ng-click="setPage(page)">{{ page }}</a>    </li>    <li ng-class="{disabled:      params.offset + params.limit >= params.total}">      <a href ng-click="setPage(currPage + 1)">Next</a>      </li>      <li ng-class="{disabled:        params.offset + params.limit >= params.total}">        <a href ng-click="setPage(maxPage)">Last</a>        </li>        </ul>',link:function(a,b,c,d){var e=10;a.params=d.paginationParams,a.setPage=function(b){b>=1&&b<=a.maxPage&&(a.params.offset=(b-1)*a.params.limit)},a.$watch("params",function(b){for(var c=Math.floor(b.offset/b.limit),d=Math.ceil(b.total/b.limit)-1,f=Math.max(0,Math.min(c-Math.ceil(e/2),d-e+1)),g=[],h=f,i=0;d>=h&&e>i;i++)g.push(h+1),h++;a.maxPage=d+1,a.currPage=c+1,a.showPages=g,a.offset=b.offset},!0),a.$watch("params.total",function(){a.params.offset=0}),c.$observe("total",function(b){isNaN(parseInt(b,10))||(a.params.total=parseInt(b,10),a.params.remote=!0)}),c.$observe("limit",function(b){isNaN(parseInt(b,10))||(a.params.limit=parseInt(b,10))}),c.$observe("indices",function(a){isNaN(parseInt(a,10))||(e=parseInt(a,10))})}}}),angular.module("siTable.directives").directive("sortBy",function(){return{restrict:"A",transclude:!0,replace:!0,scope:!0,require:"^siTable",template:'    <th class="sort" ng-click="sort()" ng-class="{      \'sort-asc\': state === \'asc\',      \'sort-desc\': state === \'desc\'    }">    <a href ng-transclude></a>    <span class="sort-caret sort-asc"    ng-if="state === \'asc\'">&#9660;</span>    <span class="sort-caret sort-desc"    ng-if="state === \'desc\'">&#9650;</span>    </th>',link:function(a,b,c,d){var e=d.sortingParams;c.$observe("sortBy",function(b){a.sortBy=b}),"desc"===c.sortInit?(e.sortArray.push("-"+c.sortBy),a.state="desc"):c.sortInit&&(e.sortArray.push(c.sortBy),a.state="asc"),a.sort=function(){var b=c.sortBy;b&&e&&(-1!==e.sortArray.indexOf(b)?(e.sortArray[e.sortArray.indexOf(b)]="-"+b,a.state="desc"):-1!==e.sortArray.indexOf("-"+b)?(e.sortArray.splice(e.sortArray.indexOf("-"+b),1),a.state=""):(e.sortArray.push(b),a.state="asc"))}}}}),angular.module("siTable.directives").directive("tr",function(){return{restrict:"E",priority:1001,require:"?^siTable",scope:!0,compile:function(){return{pre:function(a,b,c,d){d&&c.ngRepeat&&(c.ngRepeat+=" | orderBy:sortingParams.sortArray",c.ngRepeat+=" | siPagination:paginationParams")},post:function(a,b,c,d){if(d){if(a.paginationParams=d.paginationParams,c.ngRepeat){var e=c.ngRepeat.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?\s*$/),f=e[2].split("|")[0].trim();a.$watchCollection(f,function(){a.paginationParams.offset=0})}a.$watch("paginationParams.remote",function(b){a.sortingParams=b?{}:d.sortingParams})}}}}}}),angular.module("siTable.filters").filter("siPagination",function(){return function(a,b){return!b||b.remote?a:(a&&(b.total=a.length),a&&a.length?a.slice(b.offset,b.offset+b.limit):[])}})}(window,document);